"use strict";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function e(e,t,i,n){return new(i||(i=Promise))((function(a,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function l(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,l)}c((n=n.apply(e,t||[])).next())}))}figma.showUI(__html__,{width:340,height:220});const t=[];let i,n;let a=50,o=50,s=0,l=0,c=[],d=!1;figma.ui.onmessage=f=>e(void 0,void 0,void 0,(function*(){if("init"===f.type)try{yield figma.loadFontAsync({family:"Open Sans",style:"Regular"})}catch(e){figma.notify(e)}if("load-fonts"===f.type)try{yield figma.loadFontAsync({family:f.font,style:"Regular"}),figma.notify(`${f.font} is installed`),figma.ui.postMessage({type:"analyze-selection",fontInstalled:!0})}catch(e){figma.ui.postMessage({type:"analyze-selection",fontInstalled:!1}),figma.notify(e)}if("collect-nodes"===f.type&&0===c.length){figma.root.findAll(e=>"COMPONENT"===e.type).forEach(e=>{c.push(e.name)}),figma.ui.postMessage({nodesCollected:!0,type:"nodes-collected"})}if("create-icon"===f.type){let e=0===f.count?0:f.count-1;0===e?(figma.ui.postMessage({workingState:d,count:e,completed:l,skipped:s,nodesCollected:!0,type:"loop-end"}),function(){let e="";0===s&&0===t.length?(e="No icons found.",figma.getNodeById(i).remove()):s>0&&0===t.length?(e=`No new icons found. ${s} icons already exist.`,figma.getNodeById(i).remove()):e=s>0&&1===t.length?`Added ${t.length} new icon! ${s} icons already exist.`:s>0&&t.length>1?`Added ${t.length} new icons! ${s} icons already exist.`:`Added ${t.length} new icons!`;figma.notify(e),figma.ui.postMessage({type:"results",message:e})}(),a=50,o=50,s=0,c=[]):(!function(e,f,g){const r=e.properties.name.split(", ")[0],m=g+r;if(d=!0,null==figma.getNodeById(i)){const e=figma.createFrame();e.visible=!1,figma.currentPage.appendChild(e),e.x=figma.viewport.center.x-420,e.y=figma.viewport.center.y,i=e.id,n=figma.getNodeById(i)}else n=figma.getNodeById(i);if(c.includes(m))s+=1;else{n.visible=!0;const i=figma.createFrame(),s=figma.createComponent(),c=figma.createText(),d=figma.createText(),g=figma.createRectangle();i.resize(65,65),g.resize(65,65),g.opacity=0,g.locked=!0,s.name=m,s.resize(20,20),s.appendChild(c),s.description=`(Master Component):\nCSS Class: ${m}}`,i.appendChild(d),i.appendChild(s),i.insertChild(0,g),c.fontName={family:f,style:"Regular"},c.characters=String.fromCharCode(e.properties.code),c.textAlignHorizontal="CENTER",c.name="Icon",c.fontSize=20,c.resize(20,20),c.x=0,c.y=0,i.name=m,i.x=a,i.y=o,d.name="CSS Class",d.fontName={family:"Open Sans",style:"Regular"},d.characters=m,d.textAlignHorizontal="CENTER",d.fontSize=6,s.x=i.width/2-s.width/2,s.y=10,d.x=i.width/2-d.width/2,d.y=35;const r=figma.group([d,s,g],figma.currentPage);r.name=m,i.remove(),n.appendChild(r),t.push(r),a=a+65+10,a>790&&(o=o+65+10,a=50),n.resize(840,o+65+10+50),l+=1}}(f.icon,f.font,f.prefix),figma.ui.postMessage({workingState:d,count:e,completed:l,skipped:s,nodesCollected:!0,type:"create-end"}))}}));
